(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9667],{49930:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/friends",function(){return t(4697)}])},70525:function(e,s,t){"use strict";t.d(s,{Z:function(){return f}});var i=t(85893),a=t(67294),n=t(58589),r=t(98842),l=t(25062),c=t(4683),d=t(38824),o=t(77424),h=t(41664),m=t.n(h),x=t(25675),u=t.n(x);function f(e){let{role:s}=e,[t,h]=(0,a.useState)([]),[x,f]=(0,a.useState)(0);(0,a.useEffect)(()=>{j()},[]);let j=async()=>{try{let e=localStorage.getItem("token"),s=await fetch("/api/notifications",{headers:{Authorization:"Bearer ".concat(e)}}),t=await s.json();t.success&&(h(t.data),f(t.data.filter(e=>!e.isRead).length))}catch(e){console.error("Error fetching notifications:",e)}};return(0,i.jsxs)(n.Z,{children:[(0,i.jsxs)(r.Z,{nav:!0,className:"position-relative",children:[(0,i.jsx)(o.Z,{size:20}),x>0&&(0,i.jsx)(l.Z,{color:"danger",pill:!0,className:"position-absolute",style:{top:"-5px",right:"-5px"},children:x})]}),(0,i.jsxs)(c.Z,{end:!0,className:"notification-dropdown p-0",style:{width:"320px",maxHeight:"400px"},children:[(0,i.jsxs)("div",{className:"p-2 border-bottom d-flex justify-content-between align-items-center",children:[(0,i.jsx)("h6",{className:"mb-0",children:"Notifications"}),(0,i.jsx)(m(),{href:s?"/".concat(s,"/notifications"):"/user/notifications",className:"text-muted small",children:"View All"})]}),(0,i.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto"},children:0===t.length?(0,i.jsx)(d.Z,{text:!0,children:"No notifications"}):t.slice(0,5).map(e=>(0,i.jsx)(d.Z,{className:"border-bottom",children:(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[(0,i.jsx)(u(),{src:"/user1.png",alt:"User",width:40,height:40,className:"rounded-circle me-2"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"fw-bold",children:e.title}),(0,i.jsx)("small",{className:"text-muted",children:new Date(e.createdAt).toLocaleString()})]})]})},e._id))})]})]})}},73796:function(e,s,t){"use strict";t.d(s,{Z:function(){return I}});var i=t(85893),a=t(67294),n=t(79862),r=t(84082),l=t(35510),c=t(16987),d=t(58589),o=t(98842),h=t(4683),m=t(38824),x=t(11163),u=t(45007),f=t(44109),j=t(25675),p=t.n(j),g=t(25471),w=t(38571),N=t(39646),v=t(17207),b=t(83220),Z=t(81912),y=t(77662),S=t(48903),_=t(27434),k=t(4868),z=t(41664),E=t.n(z),C=t(70525),L=t(33299);function I(e){var s,t,j,z,I,q;let{children:F}=e,A=(0,x.useRouter)(),O=(0,u.I0)(),[R,T]=(0,a.useState)(!0),H=(0,L.useSession)(),P=[{text:"Dashboard",path:"/user/dashboard",icon:(0,i.jsx)(g.Z,{size:18})},{text:"Tournaments",path:"/user/dashboard/tournaments",icon:(0,i.jsx)(w.Z,{size:18})},{text:"Friends",path:"/user/friends",icon:(0,i.jsx)(N.Z,{size:18})},{text:"Statistics",path:"/user/statistics",icon:(0,i.jsx)(v.Z,{size:18})},{text:"Wallet",path:"/user/wallet",icon:(0,i.jsx)(b.Z,{size:18})},{text:"Chat",path:"/chat",icon:(0,i.jsx)(Z.Z,{size:18})},{text:"Settings",path:"/user/settings",icon:(0,i.jsx)(y.Z,{size:18})}];return(0,i.jsxs)("div",{className:"d-flex",children:[(0,i.jsxs)(n.Z,{vertical:!0,className:"bg-white border-end sidebar ".concat(R?"open":""),style:{width:R?"240px":"64px",height:"100vh",position:"fixed",left:0,top:0,zIndex:1030,transition:"all 0.3s ease-in-out"},children:[(0,i.jsx)("div",{className:"p-3 d-flex align-items-center mb-2",children:(0,i.jsxs)("div",{className:"d-flex w-100 align-items-center justify-content-between",children:[R&&(0,i.jsx)(p(),{src:"/axiom-logo.png",alt:"Axiom",width:70,height:45}),(0,i.jsx)(r.Z,{className:"p-0",color:"initial",onClick:()=>T(!R),children:(0,i.jsx)(S.Z,{size:24,style:{transform:R?"rotate(0deg)":"rotate(180deg)",transition:"transform 0.3s ease-in-out"}})})]})}),P.map(e=>(0,i.jsx)(l.Z,{children:(0,i.jsxs)(E(),{href:e.path,className:"d-flex align-items-center mb-2 px-3 py-2 ".concat(A.pathname===e.path?"bg-warning text-dark":"text-muted"),style:{textDecoration:"none"},children:[e.icon,R&&(0,i.jsx)("span",{className:"ms-2",children:e.text})]})},e.text))]}),(0,i.jsxs)("div",{style:{marginLeft:R?"240px":"64px",transition:"margin-left 0.3s ease-in-out",width:"100%"},children:[(0,i.jsx)(c.Z,{className:"bg-white border-bottom px-4",container:!1,children:(0,i.jsx)(n.Z,{className:"ms-auto d-flex align-items-center",navbar:!0,children:(0,i.jsxs)("div",{className:"d-flex align-items-center me-3",children:[(0,i.jsx)(C.Z,{})," ",(0,i.jsxs)(d.Z,{inNavbar:!0,nav:!0,className:"ms-3",children:[(0,i.jsxs)(o.Z,{nav:!0,children:[(0,i.jsx)(p(),{src:null!==(q=null===(s=H.data)||void 0===s?void 0:s.user.profileImage)&&void 0!==q?q:"/profile-avatar.png",alt:null===(j=H.data)||void 0===j?void 0:null===(t=j.user)||void 0===t?void 0:t.name,width:32,height:32,className:"rounded-circle me-2"}),null===(I=H.data)||void 0===I?void 0:null===(z=I.user)||void 0===z?void 0:z.name," ",(0,i.jsx)(_.Z,{size:16})]}),(0,i.jsx)(h.Z,{end:!0,className:"position-absolute",children:(0,i.jsxs)(m.Z,{onClick:()=>{O((0,f.kS)()),(0,L.signOut)({redirect:!1}).then(()=>A.push("/auth/login"))},children:[(0,i.jsx)(k.Z,{size:14,className:"me-2"}),"Logout"]})})]})]})})}),(0,i.jsx)("main",{className:"p-4",children:F})]})]})}},4697:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return g}});var i=t(85893),a=t(67294),n=t(73796),r=t(53637),l=t(79862),c=t(35510),d=t(81051),o=t(87261),h=t(35773),m=t(95305),x=t(84082),u=t(25675),f=t.n(u),j=t(83206),p=t(33299);function g(){let[e,s]=(0,a.useState)("myFriends"),[t,u]=(0,a.useState)(""),[g,w]=(0,a.useState)([]),[N,v]=(0,a.useState)([]),[b,Z]=(0,a.useState)([]),[y,S]=(0,a.useState)([]),[_,k]=(0,a.useState)(new Set),z=(0,p.useSession)();(0,a.useEffect)(()=>{C(),L(),E();let e=()=>{C(),L(),E()};return window.addEventListener("friendRequestHandled",e),()=>window.removeEventListener("friendRequestHandled",e)},[]);let E=async()=>{try{let e=await fetch("/api/friend-requests");if(e.ok){let s=await e.json();k(new Set(s.data))}}catch(e){console.error("Error fetching sent requests:",e)}};(0,a.useEffect)(()=>{"players"===e?v(g.filter(e=>e.name.toLowerCase().includes(t.toLowerCase()))):S(b.filter(e=>e.name.toLowerCase().includes(t.toLowerCase())))},[t,g,b,e]);let C=async()=>{try{let e=await fetch("/api/users");if(e.ok){let s=await e.json();w(s.data.filter(e=>e._id!==(null==z?void 0:z.data.user.id)&&"User"==e.role)),v(s.data)}}catch(e){console.error("Error fetching users:",e)}},L=async()=>{try{let e=await fetch("/api/users/me/friends");if(e.ok){let s=await e.json();Z(s.data),S(s.data)}}catch(e){console.error("Error fetching friends:",e)}};return(0,i.jsx)(n.Z,{children:(0,i.jsxs)(r.Z,{fluid:!0,className:"p-4",children:[(0,i.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,i.jsxs)(l.Z,{tabs:!0,className:"border-0",children:[(0,i.jsx)(c.Z,{children:(0,i.jsx)(d.Z,{className:"border-0 px-4 ".concat("myFriends"===e?"bg-warning text-dark":"text-muted"),onClick:()=>s("myFriends"),style:{cursor:"pointer"},children:"My Friends"})}),(0,i.jsx)(c.Z,{children:(0,i.jsx)(d.Z,{className:"border-0 px-4 ".concat("players"===e?"bg-warning text-dark":"text-muted"),onClick:()=>s("players"),style:{cursor:"pointer"},children:"Players"})})]}),(0,i.jsxs)("div",{className:"position-relative",style:{width:"300px"},children:[(0,i.jsx)(j.Z,{size:18,className:"position-absolute",style:{top:"10px",left:"10px"}}),(0,i.jsx)(o.Z,{placeholder:"Search",value:t,onChange:e=>u(e.target.value),className:"ps-5"})]})]}),"myFriends"===e?(0,i.jsx)(h.Z,{children:y.map(e=>(0,i.jsx)(m.Z,{md:6,className:"mb-3",children:(0,i.jsx)("div",{className:"d-flex justify-content-between align-items-center p-3 bg-white rounded shadow-sm",children:(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[(0,i.jsx)(f(),{src:e.profileImage||"/user1.png",alt:e.name,width:48,height:48,className:"rounded-circle"}),(0,i.jsxs)("div",{className:"ms-3",children:[(0,i.jsx)("h6",{className:"mb-1",children:e.name}),(0,i.jsx)("small",{className:"text-muted",children:e.email})]})]})})},e._id))}):(0,i.jsx)(h.Z,{children:N.map(e=>(0,i.jsx)(m.Z,{md:6,className:"mb-3",children:(0,i.jsxs)("div",{className:"d-flex justify-content-between align-items-center p-3 bg-white rounded shadow-sm",children:[(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[(0,i.jsx)(f(),{src:e.profileImage||"/user1.png",alt:e.name,width:48,height:48,className:"rounded-circle"}),(0,i.jsx)("div",{className:"ms-3",children:(0,i.jsx)("h6",{className:"mb-1",children:e.name})})]}),(0,i.jsx)(x.Z,{color:_.has(e._id)?"success":"info",size:"sm",onClick:async()=>{if(!_.has(e._id))try{let s=localStorage.getItem("token");(await fetch("/api/friend-requests",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({receiverId:e._id})})).ok&&k(s=>new Set([...s,e._id]))}catch(e){console.error("Error sending friend request:",e)}},disabled:_.has(e._id),children:_.has(e._id)?"Request Sent":"Add Friend"})]})},e._id))})]})})}}},function(e){e.O(0,[9594,1664,5714,5184,2888,9774,179],function(){return e(e.s=49930)}),_N_E=e.O()}]);