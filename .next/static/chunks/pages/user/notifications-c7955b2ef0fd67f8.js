(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8615],{90203:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/notifications",function(){return s(98334)}])},70525:function(e,t,s){"use strict";s.d(t,{Z:function(){return j}});var i=s(85893),n=s(67294),a=s(58589),c=s(98842),l=s(25062),r=s(4683),o=s(38824),d=s(77424),h=s(41664),x=s.n(h),m=s(25675),u=s.n(m);function j(e){let{role:t}=e,[s,h]=(0,n.useState)([]),[m,j]=(0,n.useState)(0);(0,n.useEffect)(()=>{f()},[]);let f=async()=>{try{let e=localStorage.getItem("token"),t=await fetch("/api/notifications",{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();s.success&&(h(s.data),j(s.data.filter(e=>!e.isRead).length))}catch(e){console.error("Error fetching notifications:",e)}};return(0,i.jsxs)(a.Z,{children:[(0,i.jsxs)(c.Z,{nav:!0,className:"position-relative",children:[(0,i.jsx)(d.Z,{size:20}),m>0&&(0,i.jsx)(l.Z,{color:"danger",pill:!0,className:"position-absolute",style:{top:"-5px",right:"-5px"},children:m})]}),(0,i.jsxs)(r.Z,{end:!0,className:"notification-dropdown p-0",style:{width:"320px",maxHeight:"400px"},children:[(0,i.jsxs)("div",{className:"p-2 border-bottom d-flex justify-content-between align-items-center",children:[(0,i.jsx)("h6",{className:"mb-0",children:"Notifications"}),(0,i.jsx)(x(),{href:t?"/".concat(t,"/notifications"):"/user/notifications",className:"text-muted small",children:"View All"})]}),(0,i.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto"},children:0===s.length?(0,i.jsx)(o.Z,{text:!0,children:"No notifications"}):s.slice(0,5).map(e=>(0,i.jsx)(o.Z,{className:"border-bottom",children:(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[(0,i.jsx)(u(),{src:"/user1.png",alt:"User",width:40,height:40,className:"rounded-circle me-2"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"fw-bold",children:e.title}),(0,i.jsx)("small",{className:"text-muted",children:new Date(e.createdAt).toLocaleString()})]})]})},e._id))})]})]})}},73796:function(e,t,s){"use strict";s.d(t,{Z:function(){return I}});var i=s(85893),n=s(67294),a=s(79862),c=s(84082),l=s(35510),r=s(16987),o=s(58589),d=s(98842),h=s(4683),x=s(38824),m=s(11163),u=s(45007),j=s(44109),f=s(25675),p=s.n(f),g=s(25471),N=s(38571),v=s(39646),Z=s(17207),w=s(83220),b=s(81912),y=s(77662),_=s(48903),S=s(27434),z=s(4868),k=s(41664),C=s.n(k),E=s(70525),A=s(33299);function I(e){var t,s,f,k,I,T;let{children:O}=e,R=(0,m.useRouter)(),q=(0,u.I0)(),[D,L]=(0,n.useState)(!0),P=(0,A.useSession)(),U=[{text:"Dashboard",path:"/user/dashboard",icon:(0,i.jsx)(g.Z,{size:18})},{text:"Tournaments",path:"/user/dashboard/tournaments",icon:(0,i.jsx)(N.Z,{size:18})},{text:"Friends",path:"/user/friends",icon:(0,i.jsx)(v.Z,{size:18})},{text:"Statistics",path:"/user/statistics",icon:(0,i.jsx)(Z.Z,{size:18})},{text:"Wallet",path:"/user/wallet",icon:(0,i.jsx)(w.Z,{size:18})},{text:"Chat",path:"/chat",icon:(0,i.jsx)(b.Z,{size:18})},{text:"Settings",path:"/user/settings",icon:(0,i.jsx)(y.Z,{size:18})}];return(0,i.jsxs)("div",{className:"d-flex",children:[(0,i.jsxs)(a.Z,{vertical:!0,className:"bg-white border-end sidebar ".concat(D?"open":""),style:{width:D?"240px":"64px",height:"100vh",position:"fixed",left:0,top:0,zIndex:1030,transition:"all 0.3s ease-in-out"},children:[(0,i.jsx)("div",{className:"p-3 d-flex align-items-center mb-2",children:(0,i.jsxs)("div",{className:"d-flex w-100 align-items-center justify-content-between",children:[D&&(0,i.jsx)(p(),{src:"/axiom-logo.png",alt:"Axiom",width:70,height:45}),(0,i.jsx)(c.Z,{className:"p-0",color:"initial",onClick:()=>L(!D),children:(0,i.jsx)(_.Z,{size:24,style:{transform:D?"rotate(0deg)":"rotate(180deg)",transition:"transform 0.3s ease-in-out"}})})]})}),U.map(e=>(0,i.jsx)(l.Z,{children:(0,i.jsxs)(C(),{href:e.path,className:"d-flex align-items-center mb-2 px-3 py-2 ".concat(R.pathname===e.path?"bg-warning text-dark":"text-muted"),style:{textDecoration:"none"},children:[e.icon,D&&(0,i.jsx)("span",{className:"ms-2",children:e.text})]})},e.text))]}),(0,i.jsxs)("div",{style:{marginLeft:D?"240px":"64px",transition:"margin-left 0.3s ease-in-out",width:"100%"},children:[(0,i.jsx)(r.Z,{className:"bg-white border-bottom px-4",container:!1,children:(0,i.jsx)(a.Z,{className:"ms-auto d-flex align-items-center",navbar:!0,children:(0,i.jsxs)("div",{className:"d-flex align-items-center me-3",children:[(0,i.jsx)(E.Z,{})," ",(0,i.jsxs)(o.Z,{inNavbar:!0,nav:!0,className:"ms-3",children:[(0,i.jsxs)(d.Z,{nav:!0,children:[(0,i.jsx)(p(),{src:null!==(T=null===(t=P.data)||void 0===t?void 0:t.user.profileImage)&&void 0!==T?T:"/profile-avatar.png",alt:null===(f=P.data)||void 0===f?void 0:null===(s=f.user)||void 0===s?void 0:s.name,width:32,height:32,className:"rounded-circle me-2"}),null===(I=P.data)||void 0===I?void 0:null===(k=I.user)||void 0===k?void 0:k.name," ",(0,i.jsx)(S.Z,{size:16})]}),(0,i.jsx)(h.Z,{end:!0,className:"position-absolute",children:(0,i.jsxs)(x.Z,{onClick:()=>{q((0,j.kS)()),(0,A.signOut)({redirect:!1}).then(()=>R.push("/auth/login"))},children:[(0,i.jsx)(z.Z,{size:14,className:"me-2"}),"Logout"]})})]})]})})}),(0,i.jsx)("main",{className:"p-4",children:O})]})]})}},98334:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var i=s(85893),n=s(67294),a=s(53637),c=s(79862),l=s(35510),r=s(81051),o=s(87168),d=s(35773),h=s(95305),x=s(39886),m=s(84082),u=s(73796),j=s(25675),f=s.n(j),p=s(93967),g=s.n(p);function N(){let[e,t]=(0,n.useState)("all"),[s,j]=(0,n.useState)([]),[p,N]=(0,n.useState)(!0);(0,n.useEffect)(()=>{v()},[]);let v=async()=>{try{let e=localStorage.getItem("token"),t=await fetch("/api/notifications",{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();s.success&&j(s.data)}catch(e){console.error("Error fetching notifications:",e)}finally{N(!1)}},Z=async(e,t)=>{try{let s=await fetch("/api/notifications/".concat(e,"/handle"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t})});if(s.ok){let i=await s.json();if(i.friendRequestId){await fetch("/api/friend-requests/".concat(i.friendRequestId),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})});let s=new CustomEvent("friendRequestHandled");window.dispatchEvent(s),j(s=>s.map(s=>s._id===e?{...s,status:t}:s))}}}catch(e){console.error("Error handling notification action:",e)}};return(0,i.jsx)(u.Z,{children:(0,i.jsxs)(a.Z,{children:[(0,i.jsx)("h2",{className:"mb-4",children:"Notifications"}),(0,i.jsxs)(c.Z,{tabs:!0,className:"mb-4",children:[(0,i.jsx)(l.Z,{children:(0,i.jsx)(r.Z,{className:g()({active:"all"===e}),onClick:()=>t("all"),children:"All"})}),(0,i.jsx)(l.Z,{children:(0,i.jsx)(r.Z,{className:g()({active:"unread"===e}),onClick:()=>t("unread"),children:"Unread"})})]}),p?(0,i.jsx)("div",{className:"text-center",children:(0,i.jsx)(o.Z,{color:"primary"})}):(0,i.jsx)(d.Z,{children:s.map(e=>(0,i.jsx)(h.Z,{md:12,className:"mb-3",children:(0,i.jsx)(x.Z,{body:!0,children:(0,i.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[(0,i.jsx)(f(),{src:"/user1.png",alt:"User",width:40,height:40,className:"rounded-circle me-3"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h6",{className:"mb-1",children:e.title}),(0,i.jsx)("small",{className:"text-muted",children:new Date(e.createdAt).toLocaleString()})]})]}),"friend_request"===e.type&&"pending"===e.status&&(0,i.jsxs)("div",{children:[(0,i.jsx)(m.Z,{color:"success",size:"sm",className:"me-2",onClick:()=>Z(e._id,"accepted"),children:"Accept"}),(0,i.jsx)(m.Z,{color:"danger",size:"sm",onClick:()=>Z(e._id,"rejected"),children:"Reject"})]})]})})},e._id))})]})})}}},function(e){e.O(0,[9594,1664,5714,6242,2888,9774,179],function(){return e(e.s=90203)}),_N_E=e.O()}]);