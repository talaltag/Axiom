(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8259],{3473:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/support-agent/notifications",function(){return s(9833)}])},70525:function(e,t,s){"use strict";s.d(t,{Z:function(){return f}});var i=s(85893),n=s(67294),a=s(58589),c=s(98842),r=s(25062),l=s(4683),o=s(38824),d=s(77424),h=s(41664),x=s.n(h),m=s(25675),u=s.n(m);function f(e){let{role:t}=e,[s,h]=(0,n.useState)([]),[m,f]=(0,n.useState)(0);(0,n.useEffect)(()=>{p()},[]);let p=async()=>{try{let e=localStorage.getItem("token"),t=await fetch("/api/notifications",{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();s.success&&(h(s.data),f(s.data.filter(e=>!e.isRead).length))}catch(e){console.error("Error fetching notifications:",e)}};return(0,i.jsxs)(a.Z,{children:[(0,i.jsxs)(c.Z,{nav:!0,className:"position-relative",children:[(0,i.jsx)(d.Z,{size:20}),m>0&&(0,i.jsx)(r.Z,{color:"danger",pill:!0,className:"position-absolute",style:{top:"-5px",right:"-5px"},children:m})]}),(0,i.jsxs)(l.Z,{end:!0,className:"notification-dropdown p-0",style:{width:"320px",maxHeight:"400px"},children:[(0,i.jsxs)("div",{className:"p-2 border-bottom d-flex justify-content-between align-items-center",children:[(0,i.jsx)("h6",{className:"mb-0",children:"Notifications"}),(0,i.jsx)(x(),{href:t?"/".concat(t,"/notifications"):"/user/notifications",className:"text-muted small",children:"View All"})]}),(0,i.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto"},children:0===s.length?(0,i.jsx)(o.Z,{text:!0,children:"No notifications"}):s.slice(0,5).map(e=>(0,i.jsx)(o.Z,{className:"border-bottom",children:(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[(0,i.jsx)(u(),{src:"/user1.png",alt:"User",width:40,height:40,className:"rounded-circle me-2"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"fw-bold",children:e.title}),(0,i.jsx)("small",{className:"text-muted",children:new Date(e.createdAt).toLocaleString()})]})]})},e._id))})]})]})}},36931:function(e,t,s){"use strict";s.d(t,{Z:function(){return S}});var i=s(85893),n=s(67294),a=s(79862),c=s(84082),r=s(35510),l=s(16987),o=s(58589),d=s(98842),h=s(4683),x=s(38824),m=s(11163),u=s(45007),f=s(44109),p=s(25675),j=s.n(p),g=s(81912),N=s(77662),v=s(48903),w=s(4868),Z=s(70525),b=s(33299),y=s(41664),_=s.n(y);function S(e){var t,s;let{children:p}=e,y=(0,m.useRouter)(),S=(0,u.I0)(),[k,z]=(0,n.useState)(!0),C=(0,b.useSession)(),E=[{text:"Chat",path:"/support-agent",icon:(0,i.jsx)(g.Z,{size:18})},{text:"Settings",path:"/support-agent/settings",icon:(0,i.jsx)(N.Z,{size:18})}];return(0,i.jsxs)("div",{className:"d-flex",children:[(0,i.jsxs)(a.Z,{vertical:!0,className:"bg-white border-end sidebar ".concat(k?"open":""),style:{width:k?"240px":"64px",height:"100vh",position:"fixed",left:0,top:0,zIndex:1030,transition:"all 0.3s ease-in-out"},children:[(0,i.jsx)("div",{className:"p-3 d-flex align-items-center mb-2",children:(0,i.jsxs)("div",{className:"d-flex w-100 align-items-center justify-content-between",children:[k&&(0,i.jsx)(j(),{src:"/axiom-logo.png",alt:"Axiom",width:70,height:45}),(0,i.jsx)(c.Z,{className:"p-0",color:"initial",onClick:()=>z(!k),children:(0,i.jsx)(v.Z,{size:24,style:{transform:k?"rotate(0deg)":"rotate(180deg)",transition:"transform 0.3s ease-in-out"}})})]})}),E.map(e=>(0,i.jsx)(r.Z,{children:(0,i.jsxs)(_(),{href:e.path,className:"d-flex align-items-center mb-2 px-3 py-2 ".concat(y.pathname===e.path?"bg-warning text-dark":"text-muted"),style:{textDecoration:"none"},children:[e.icon,k&&(0,i.jsx)("span",{className:"ms-2",children:e.text})]})},e.text))]}),(0,i.jsxs)("div",{style:{marginLeft:k?"240px":"64px",transition:"margin-left 0.3s ease-in-out",width:"100%"},children:[(0,i.jsx)(l.Z,{className:"bg-white border-bottom px-4",container:!1,children:(0,i.jsx)(a.Z,{className:"ms-auto d-flex align-items-center",navbar:!0,children:(0,i.jsxs)("div",{className:"d-flex align-items-center me-3",children:[(0,i.jsx)(Z.Z,{role:"support-agent"})," ",(0,i.jsxs)(o.Z,{dropup:!0,inNavbar:!0,nav:!0,className:"ms-3",children:[(0,i.jsx)(d.Z,{nav:!0,children:(0,i.jsx)(j(),{src:(null==C?void 0:null===(s=C.data)||void 0===s?void 0:null===(t=s.user)||void 0===t?void 0:t.profileImage)||"/profile-avatar.png",alt:"User",width:32,height:32,className:"rounded-circle"})}),(0,i.jsx)(h.Z,{end:!0,className:"position-absolute",children:(0,i.jsxs)(x.Z,{onClick:()=>{S((0,f.kS)()),(0,b.signOut)({redirect:!1}).then(()=>y.push("/auth/login"))},children:[(0,i.jsx)(w.Z,{size:14,className:"me-2"}),"Logout"]})})]})]})})}),(0,i.jsx)("main",{className:"p-4",children:p})]})]})}},9833:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var i=s(85893),n=s(67294),a=s(53637),c=s(79862),r=s(35510),l=s(81051),o=s(87168),d=s(35773),h=s(95305),x=s(39886),m=s(84082),u=s(25675),f=s.n(u),p=s(93967),j=s.n(p),g=s(36931);function N(){let[e,t]=(0,n.useState)("all"),[s,u]=(0,n.useState)([]),[p,N]=(0,n.useState)(!0);(0,n.useEffect)(()=>{v()},[]);let v=async()=>{try{let e=localStorage.getItem("token"),t=await fetch("/api/notifications",{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();s.success&&u(s.data)}catch(e){console.error("Error fetching notifications:",e)}finally{N(!1)}},w=async(e,t)=>{try{let s=localStorage.getItem("token"),i=await fetch("/api/notifications/".concat(e,"/handle"),{method:"POST",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},body:JSON.stringify({action:t})});if(i.ok){let n=await i.json();if(n.friendRequestId){await fetch("/api/friend-requests/".concat(n.friendRequestId),{method:"PUT",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},body:JSON.stringify({status:t})});let i=new CustomEvent("friendRequestHandled");window.dispatchEvent(i),u(s=>s.map(s=>s._id===e?{...s,status:t}:s))}}}catch(e){console.error("Error handling notification action:",e)}};return(0,i.jsx)(g.Z,{children:(0,i.jsxs)(a.Z,{children:[(0,i.jsx)("h2",{className:"mb-4",children:"Notifications"}),(0,i.jsxs)(c.Z,{tabs:!0,className:"mb-4",children:[(0,i.jsx)(r.Z,{children:(0,i.jsx)(l.Z,{className:j()({active:"all"===e}),onClick:()=>t("all"),children:"All"})}),(0,i.jsx)(r.Z,{children:(0,i.jsx)(l.Z,{className:j()({active:"unread"===e}),onClick:()=>t("unread"),children:"Unread"})})]}),p?(0,i.jsx)("div",{className:"text-center",children:(0,i.jsx)(o.Z,{color:"primary"})}):(0,i.jsx)(d.Z,{children:s.map(e=>(0,i.jsx)(h.Z,{md:12,className:"mb-3",children:(0,i.jsx)(x.Z,{body:!0,children:(0,i.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[(0,i.jsx)(f(),{src:"/user1.png",alt:"User",width:40,height:40,className:"rounded-circle me-3"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h6",{className:"mb-1",children:e.title}),(0,i.jsx)("small",{className:"text-muted",children:new Date(e.createdAt).toLocaleDateString()})]})]}),"friend_request"===e.type&&"pending"===e.status&&(0,i.jsxs)("div",{children:[(0,i.jsx)(m.Z,{color:"success",size:"sm",className:"me-2",onClick:()=>w(e._id,"accepted"),children:"Accept"}),(0,i.jsx)(m.Z,{color:"danger",size:"sm",onClick:()=>w(e._id,"rejected"),children:"Reject"})]})]})})},e._id))})]})})}}},function(e){e.O(0,[9594,1664,5714,8803,2888,9774,179],function(){return e(e.s=3473)}),_N_E=e.O()}]);