(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8180],{80022:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return s(43741)}])},70525:function(e,t,s){"use strict";s.d(t,{Z:function(){return f}});var i=s(85893),n=s(67294),a=s(58589),r=s(98842),l=s(25062),c=s(4683),o=s(38824),d=s(77424),h=s(41664),x=s.n(h),u=s(25675),m=s.n(u);function f(e){let{role:t}=e,[s,h]=(0,n.useState)([]),[u,f]=(0,n.useState)(0);(0,n.useEffect)(()=>{j()},[]);let j=async()=>{try{let e=localStorage.getItem("token"),t=await fetch("/api/notifications",{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();s.success&&(h(s.data),f(s.data.filter(e=>!e.isRead).length))}catch(e){console.error("Error fetching notifications:",e)}};return(0,i.jsxs)(a.Z,{children:[(0,i.jsxs)(r.Z,{nav:!0,className:"position-relative",children:[(0,i.jsx)(d.Z,{size:20}),u>0&&(0,i.jsx)(l.Z,{color:"danger",pill:!0,className:"position-absolute",style:{top:"-5px",right:"-5px"},children:u})]}),(0,i.jsxs)(c.Z,{end:!0,className:"notification-dropdown p-0",style:{width:"320px",maxHeight:"400px"},children:[(0,i.jsxs)("div",{className:"p-2 border-bottom d-flex justify-content-between align-items-center",children:[(0,i.jsx)("h6",{className:"mb-0",children:"Notifications"}),(0,i.jsx)(x(),{href:t?"/".concat(t,"/notifications"):"/user/notifications",className:"text-muted small",children:"View All"})]}),(0,i.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto"},children:0===s.length?(0,i.jsx)(o.Z,{text:!0,children:"No notifications"}):s.slice(0,5).map(e=>(0,i.jsx)(o.Z,{className:"border-bottom",children:(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[(0,i.jsx)(m(),{src:"/user1.png",alt:"User",width:40,height:40,className:"rounded-circle me-2"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"fw-bold",children:e.title}),(0,i.jsx)("small",{className:"text-muted",children:new Date(e.createdAt).toLocaleString()})]})]})},e._id))})]})]})}},73796:function(e,t,s){"use strict";s.d(t,{Z:function(){return P}});var i=s(85893),n=s(67294),a=s(79862),r=s(84082),l=s(35510),c=s(16987),o=s(58589),d=s(98842),h=s(4683),x=s(38824),u=s(11163),m=s(45007),f=s(44109),j=s(25675),p=s.n(j),g=s(25471),Z=s(38571),v=s(39646),N=s(17207),w=s(83220),b=s(81912),y=s(77662),_=s(48903),S=s(27434),z=s(4868),k=s(41664),E=s.n(k),I=s(70525),C=s(33299);function P(e){var t,s,j,k,P,A;let{children:D}=e,F=(0,u.useRouter)(),L=(0,m.I0)(),[O,R]=(0,n.useState)(!0),T=(0,C.useSession)(),H=[{text:"Dashboard",path:"/user/dashboard",icon:(0,i.jsx)(g.Z,{size:18})},{text:"Tournaments",path:"/user/dashboard/tournaments",icon:(0,i.jsx)(Z.Z,{size:18})},{text:"Friends",path:"/user/friends",icon:(0,i.jsx)(v.Z,{size:18})},{text:"Statistics",path:"/user/statistics",icon:(0,i.jsx)(N.Z,{size:18})},{text:"Wallet",path:"/user/wallet",icon:(0,i.jsx)(w.Z,{size:18})},{text:"Chat",path:"/chat",icon:(0,i.jsx)(b.Z,{size:18})},{text:"Settings",path:"/user/settings",icon:(0,i.jsx)(y.Z,{size:18})}];return(0,i.jsxs)("div",{className:"d-flex",children:[(0,i.jsxs)(a.Z,{vertical:!0,className:"bg-white border-end sidebar ".concat(O?"open":""),style:{width:O?"240px":"64px",height:"100vh",position:"fixed",left:0,top:0,zIndex:1030,transition:"all 0.3s ease-in-out"},children:[(0,i.jsx)("div",{className:"p-3 d-flex align-items-center mb-2",children:(0,i.jsxs)("div",{className:"d-flex w-100 align-items-center justify-content-between",children:[O&&(0,i.jsx)(p(),{src:"/axiom-logo.png",alt:"Axiom",width:70,height:45}),(0,i.jsx)(r.Z,{className:"p-0",color:"initial",onClick:()=>R(!O),children:(0,i.jsx)(_.Z,{size:24,style:{transform:O?"rotate(0deg)":"rotate(180deg)",transition:"transform 0.3s ease-in-out"}})})]})}),H.map(e=>(0,i.jsx)(l.Z,{children:(0,i.jsxs)(E(),{href:e.path,className:"d-flex align-items-center mb-2 px-3 py-2 ".concat(F.pathname===e.path?"bg-warning text-dark":"text-muted"),style:{textDecoration:"none"},children:[e.icon,O&&(0,i.jsx)("span",{className:"ms-2",children:e.text})]})},e.text))]}),(0,i.jsxs)("div",{style:{marginLeft:O?"240px":"64px",transition:"margin-left 0.3s ease-in-out",width:"100%"},children:[(0,i.jsx)(c.Z,{className:"bg-white border-bottom px-4",container:!1,children:(0,i.jsx)(a.Z,{className:"ms-auto d-flex align-items-center",navbar:!0,children:(0,i.jsxs)("div",{className:"d-flex align-items-center me-3",children:[(0,i.jsx)(I.Z,{})," ",(0,i.jsxs)(o.Z,{inNavbar:!0,nav:!0,className:"ms-3",children:[(0,i.jsxs)(d.Z,{nav:!0,children:[(0,i.jsx)(p(),{src:null!==(A=null===(t=T.data)||void 0===t?void 0:t.user.profileImage)&&void 0!==A?A:"/profile-avatar.png",alt:null===(j=T.data)||void 0===j?void 0:null===(s=j.user)||void 0===s?void 0:s.name,width:32,height:32,className:"rounded-circle me-2"}),null===(P=T.data)||void 0===P?void 0:null===(k=P.user)||void 0===k?void 0:k.name," ",(0,i.jsx)(S.Z,{size:16})]}),(0,i.jsx)(h.Z,{end:!0,className:"position-absolute",children:(0,i.jsxs)(x.Z,{onClick:()=>{L((0,f.kS)()),(0,C.signOut)({redirect:!1}).then(()=>F.push("/auth/login"))},children:[(0,i.jsx)(z.Z,{size:14,className:"me-2"}),"Logout"]})})]})]})})}),(0,i.jsx)("main",{className:"p-4",children:D})]})]})}},43741:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var i=s(85893),n=s(67294),a=s(9729),r=s(97182),l=s(68573),c=s(31754),o=s(47407),d=s(85770),h=s(87590),x=s(55895),u=s(32200),m=s(73796),f=s(58339),j=s(33299),p=s(11163);function g(){let[e,t]=(0,n.useState)([]),[s,g]=(0,n.useState)(null),[Z,v]=(0,n.useState)(null),[N,w]=(0,n.useState)(!0),[b,y]=(0,n.useState)(null),_=(0,j.useSession)(),{receiver:S}=(0,p.useRouter)().query;return((0,n.useEffect)(()=>{_.data&&(async()=>{try{w(!0);let[e,s]=await Promise.all(["Admin"===_.data.user.role?fetch("/api/users"):fetch("/api/users/me/friends?others=true"),S?fetch("/api/users/".concat(S)):Promise.resolve(null)]);if(!e.ok)throw Error("Failed to fetch users");let i=await e.json(),n=null;if(s){let e=await s.json();e.success&&(n=e.data)}let a=i.data;if(t(a),n)g(n);else if(S){let e=a.find(e=>e._id===S);e&&g(e)}}catch(e){console.error("Error fetching data:",e),y("Failed to load users")}finally{w(!1)}})()},[_.data,S]),(0,n.useEffect)(()=>{var e,t;(null===(t=_.data)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.id)&&_.data.user.name&&v({_id:_.data.user.id,name:_.data.user.name,profileImage:_.data.user.profileImage})},[_.data]),N)?(0,i.jsx)(m.Z,{children:(0,i.jsx)(a.Z,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:(0,i.jsx)(r.Z,{})})}):b?(0,i.jsx)(m.Z,{children:(0,i.jsx)(a.Z,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:b})}):(0,i.jsx)(m.Z,{children:(0,i.jsx)(a.Z,{sx:{flexGrow:1,height:"calc(100vh - 100px)"},children:(0,i.jsxs)(l.ZP,{container:!0,spacing:2,sx:{height:"100%"},children:[(0,i.jsx)(l.ZP,{item:!0,xs:3,children:(0,i.jsx)(c.Z,{sx:{height:"100%",overflow:"auto"},children:(0,i.jsx)(o.Z,{children:e&&e.map(e=>(0,i.jsxs)(d.ZP,{button:!0,selected:(null==s?void 0:s._id)===e._id,onClick:()=>g(e),children:[(0,i.jsx)(h.Z,{children:(0,i.jsx)(x.Z,{src:e.profileImage})}),(0,i.jsx)(u.Z,{primary:e.name})]},e._id))})})}),(0,i.jsx)(l.ZP,{item:!0,xs:9,children:(0,i.jsx)(c.Z,{sx:{height:"100%"},children:s&&Z?(0,i.jsx)(f.Z,{currentUser:Z,receiver:s}):(0,i.jsx)(a.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",color:"text.secondary"},children:"Select a user to start chatting"})})})]})})})}}},function(e){e.O(0,[4885,9594,1664,5714,8662,7770,6050,2191,1509,3861,8339,2888,9774,179],function(){return e(e.s=80022)}),_N_E=e.O()}]);