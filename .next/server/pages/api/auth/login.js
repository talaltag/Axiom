"use strict";(()=>{var e={};e.id=3908,e.ids=[3908],e.modules={98432:e=>{e.exports=require("bcryptjs")},99344:e=>{e.exports=require("jsonwebtoken")},11185:e=>{e.exports=require("mongoose")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},56249:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},8686:(e,r,t)=>{t.r(r),t.d(r,{config:()=>g,default:()=>f,routeModule:()=>y});var n={};t.r(n),t.d(n,{default:()=>m});var o=t(71802),s=t(47153),i=t(56249),a=t(98432),l=t.n(a),u=t(99344),d=t.n(u),c=t(39352),p=t(70971);if(!p.Z)throw Error("Failed to import User model");async function m(e,r){if("POST"!==e.method)return r.status(405).json({message:"Method not allowed"});try{await (0,c.Z)();let{email:t,password:n}=e.body;if(!t||!n)return r.status(400).json({message:"Email and password are required"});let o=await p.Z.findOne({email:t}).select("+password");if(!o||!await l().compare(n,o.password))return r.status(401).json({message:"Invalid credentials"});let s=d().sign({userId:o._id,role:o.role},process.env.JWT_SECRET||"your-secret-key",{expiresIn:"1d"}),i={id:o._id,name:o.name,email:o.email,role:o.role};r.status(200).json({success:!0,token:s,user:i})}catch(e){console.error("Login error:",e),r.status(500).json({success:!1,message:e instanceof Error?e.message:"Server error during login"})}}let f=(0,i.l)(n,"default"),g=(0,i.l)(n,"config"),y=new o.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/auth/login",pathname:"/api/auth/login",bundlePath:"",filename:""},userland:n})},39352:(e,r,t)=>{t.d(r,{Z:()=>a});var n=t(11185),o=t.n(n);let s="mongodb+srv://nolantapps:oCOt2NNcEQKUZcuj@impacto-cluster.s20zbjj.mongodb.net/axiom?retryWrites=true&w=majority";if(!s)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let i=global.mongoose;i||(i=global.mongoose={conn:null,promise:null});let a=async function(){if(i.conn)return i.conn;i.promise||(i.promise=o().connect(s,{bufferCommands:!0}));try{return i.conn=await i.promise,console.log("MongoDB Connected Successfully"),i.conn}catch(e){throw i.promise=null,console.error("MongoDB Connection Error:",e),e}}},70971:(e,r,t)=>{t.d(r,{Z:()=>i});var n=t(11185),o=t.n(n);let s=new(o()).Schema({name:{type:String,required:!0},walletBalance:{type:Number,default:0},stripeConnectId:{type:String,default:null},stripeAccountStatus:{type:String,enum:["pending","active","rejected","restricted"],default:"pending"},email:{type:String,required:!0,unique:!0},password:{type:String,required:!0},role:{type:String,enum:["Admin","User","Agent","Super"],default:"User"},cName:String,profileImage:{type:String,required:!1},friends:[{type:o().Schema.Types.ObjectId,ref:"User"}],createdAt:{type:Date,default:Date.now}}),i=o().models.User||o().model("User",s)},47153:(e,r)=>{var t;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))},71802:(e,r,t)=>{e.exports=t(20145)}};var r=require("../../../webpack-api-runtime.js");r.C(e);var t=r(r.s=8686);module.exports=t})();